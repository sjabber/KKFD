<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!--
  <link rel="stylesheet" type="text/css" href="./css/mylist.css" />
  <link rel="stylesheet" type="text/css" href="./css/public.css" />
   -->
  <link rel="stylesheet" type="text/css" href="/css/mylist.css" />
  <link rel="stylesheet" type="text/css" href="/css/public.css" />

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj"
    crossorigin="anonymous"></script>
  <title>크크펀딩</title>
  <script src="https://use.fontawesome.com/releases/v5.2.0/js/all.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

  <script>

    function dayBetween(startDay, endDay) {
      var termMiliSec = endDay.getTime() - startDay.getTime();
      var term = termMiliSec / ((60 * 1000 * 60 * 24));
      return Math.floor(term);
    }

    function mylist(page) {
      var backurl = 'http://localhost:9999/kkfd/creator/projects/' + page;
      $.ajax({
        "url": backurl,
        "method": "GET",
        "transformRequest": [null],
        "transformResponse": [null],
        "jsonpCallbackParam": "callback",
        "headers": {
          "Accept": "application/json, text/plain, */*"
        },
        "timeout": {},
        success: function (responseObj) {
          //0:취소
          //1:정상(10:진행예정 / 11:달성률<25 / 12: 25<=달성률<75 / 13: 75<=달성률<100 / 15:100<=달성률<제한수량 /  19:제한수량도달)
          //2:마감(20:실패, 21:성공)
          var $trObj = $('body > section > div.my > table.ongoing tr.data');//취소가능 테이블 tr원본객체
          var $trObj2 = $('body > section > div.my > table.allProj tr.data');//전체 테이블 tr원본객체
          //[load시에만 진행예정&진행중 프로젝트 표시]
          if (page == 1) {
            var now = new Date();
            $(responseObj).each(function (i, pd) {
              if (pd.list.status > 9 && pd.list.status < 20) {
                var totalFm = pd.list.projFm * pd.list.projQuantity;
                var $trCopyObj = $trObj.clone(); //tr 복제본객체
                var restDay = dayBetween(now, pd.list.projEnd);
                $trCopyObj.show();
                $trCopyObj.find('th.projNo').html(pd.list.projNo);
                $trCopyObj.find('a.projTitle').html(pd.list.projTilte).prop('href', '/kkfd/project/info.html?no=' + projNo);
                $trCopyObj.find('td.totalFm').html(totalFm + '원');
                $trCopyObj.find('td.restDay').html(restDay + '일');

                var btnHtml = '';
                btnHtml += '<button type="button" class="btn btn-outline-danger btn-sm cancle" '
                btnHtml += 'value="';
                btnHtml += pd.list.projNo;
                btnHtml += '">취소</button >';

                var pst = pd.list.projGoals;
                var $progressBar = $trCopyObj.find('div.progress-bar');
                switch (pd.list.projStatus) {
                  case 10:  //진행예정
                    $trCopyObj.find('div.progress').append('진행예정');
                    $trCopyObj.find('td.cancel').html(btnHtml);
                    break;
                  case 11:  //25%이하 : 노랑
                    $progressBar.css('width', pst * 2).attr('aria-valuenow', pst).html(pst + ' % ');
                    $progressBar.addClass('bg-warning');
                    $trCopyObj.find('td.cancel').html(btnHtml);
                    break;
                  case 12:  //25%~75% : 파랑
                    $progressBar.css('width', pst * 2).attr('aria-valuenow', pst).html(pst + ' % ');
                    $progressBar.addClass('bg-primary');
                    $trCopyObj.find('td.cancel').html(btnHtml);
                    break;
                  case 13: //75%~100% : 청록
                    $progressBar.css('width', pst * 2).attr('aria-valuenow', pst).html(pst + ' % ');
                    $progressBar.addClass('bg-info');
                    $trCopyObj.find('td.cancel').html(btnHtml);
                    break;
                  case 15: //100%~제한수량 : 초록
                    $progressBar.css('width', 100 * 2).attr('aria-valuenow', 100).html(pst + ' % ');
                    $progressBar.addClass('bg-success');
                    break;
                  default:  //제한수량 도달
                    $progressBar.css('width', 100 * 2).attr('aria-valuenow', 100).html('제한수량도달');
                    $progressBar.addClass('bg-secondary')
                    break;
                }
              }
              $trObj.parent().append($trCopyObj); //tr의 부모인 table에 tr복제본을 마지막자식요소로 추가한다
            });//end of each
          }//end of if

          //[전체 테이블 페이지요청에 따라 교체]
          $(responseObj).each(function (i, pd) {
            var $trObj2 = $('body > section > div.my > table.allProj tr.data');//전체 테이블 tr원본객체

            var $trCopyObj2 = $trObj.clone(); //tr 복제본객체
            $('body > section > div.my > table.allProj tr').not(":first").remove();//이전 프로젝트 목록지우기
            var totalFm = pd.list.projFm * pd.list.projQuantity;
            $trCopyObj2.show();
            $trCopyObj2.find('th.projNo').html(pd.list.projNo);
            $trCopyObj2.find('a.projTitle').html(pd.list.projTilte).prop('href', '/kkfd/project/info.html?no=' + projNo);

            switch (pd.list.projStatus) {
              case 0:
                $trCopyObj2.find('div.state').addClass('bg-danger').html('취소');
                break;
              case 10:
                $trCopyObj2.find('div.state').addClass('bg-secondary').html('예정');
                $trCopyObj2.find('td.term').html(pd.list.projStart + '~' + pd.list.projEnd);
                break;
              case 20:
                $trCopyObj2.find('div.state').addClass('bg-warning').html('실패');
                $trCopyObj2.find('td.term').html(pd.list.projStart + '~' + pd.list.projEnd).addClass('text-decoration-line-through');
                $trCopyObj2.find('td.totalFm').html(totalFm + '원').addClass('text-decoration-line-through');
                break;
              case 21:
                var btnHtml2 = '';
                btnHtml2 += '<button type="button" class="btn btn-outline-success btn-sm joiner" '
                btnHtml2 += 'value="';
                btnHtml2 += pd.list.projNo;
                btnHtml2 += '">보기</button >';
                $trCopyObj2.find('div.state').addClass('bg-success').html('성공');
                $trCopyObj2.find('td.term').html(pd.list.projStart + '~' + pd.list.projEnd);
                $trCopyObj2.find('td.totalFm').html(totalFm + '원');
                $trCopyObj2.find('td.joiner').html(btnHtml2);
                break;
              default:
                $trCopyObj2.find('div.state').addClass('bg-primary').html('진행');
                $trCopyObj2.find('td.term').html(pd.list.projStart + '~' + pd.list.projEnd);
                $trCopyObj2.find('td.totalFm').html(totalFm + '원');
                break;

                $trObj2.parent().append($trCopyObj);
            }
          });//end of each

          var cPage = responseObj.pd.currentPage;
          var tPage = responseObj.pd.totalPage;
          var sPage = responseObj.pd.startPage;
          var ePage = responseObj.pd.endPage;
          var url = responseObj.pb.url;

          var $pageItem = $('div.pagination_container>ul.pagination').children();
          //var $pageNumItem = ;
          if (cPage == 1) {
            $pageItem.first().find('a.page-link').attr('aria-disabled', false);
          } else {
            $pageItem.first().find('a.page-link').prop('href', url + (cPage - 1));
          }
          if (cPage == 1) {
            $pageItem.first().find('a.page-link').attr('aria-disabled', false);
          } else {
            $pageItem.first().find('a.page-link').prop('href', url + (cPage - 1));
          }



          if (cPage != tPage) {

          }
          for (let k = sPage; k <= ePage; k++) {

          }
          $('div.pagination a.prev').after(aHtml);
          /*
                    <div class="pagination_container">
                      <ul class="pagination">
                        <li class="page-item disabled">
                          <a class="page-link" href="#" tabindex="-1" aria-disabled="true">&laquo;</a>
                        </li>
                        <li class="page-item"><a class="page-link" href="#">1</a></li>
                        <li class="page-item active" aria-current="page">
                          <a class="page-link" href="#">2</a>
                        </li>
                        <li class="page-item"><a class="page-link" href="#">3</a></li>
                        <li class="page-item">
                          <a class="page-link" href="#">&raquo;</a>
                        </li>
                      </ul>
                    </div>
                        </div >
                        */

        },//end of success


      });//end of Ajax

    };//end of function


    $(function () {
      /*--마이프로젝트 시작--*/
      mylist(1);
    });

  </script>
</head>

<body>
  <!-- header -->
  <header class="main_header">
    <div class="main_header_warp">
      <div class="header_menu_warp">
        <div class="header_projectsearch">
          <button class="projectsearch_item">
            <a style="text-decoration: none; color: black" href="/project/list/">
              <i class="fas fa-align-justify fa-lg"></i>
              <span class="projectsearch_name">프로젝트 둘러보기</span>
            </a>
          </button>
        </div>
        <div class="header_projectupload">
          <a style="text-decoration: none;" href="/register/registerAgree/">
            <span class="projectupload_name">프로젝트 올리기</span>
          </a>
        </div>
      </div>
      <div class="header_mainlogo">
        <a style="text-decoration: none;" href="/">
          <span class="header_mainlogo_item">크크펀딩</span>
        </a>
      </div>
      <div class="header_sub_warp">
        <div class="header_searchicon">
          <!-- <i class="fas fa-search fa-lg"></i> -->
        </div>
        <div class="header_customer_warp">
          <button class="header_customer_btn">
            <div class="header_login&signup">
              <span class="login&signup_name">
                <a href="/member/login">로그인 / 회원가입</a>
              </span>
            </div>
            <div class="header_profile_img">
              <img class="profile" src="/img/blank.png">
            </div>
          </button>
        </div>
      </div>
    </div>
  </header>
  <!-- 메인섹션 -->
  <section class="main_section">
    <div class="my">
      <div class="toptitle">
        <h3>마이페이지</h3>
      </div>
      <div class="topnav">
        <a class="member" href="/mypage/mypage.html">회원정보수정</a>
        <a class="member" href="/mypage/bmlist.html">북마크한 프로젝트</a>
        <a class="member" href="/mypage/fundlist.html">펀딩한 프로젝트</a>
        <a class="creator_active" href="/creator/cmypage">크리에이터프로필수정</a>
        <a class="creator" href="/creator/mylist">마이 프로젝트</a>
      </div>

      <br>
      <h4>진행예정 & 진행중인 프로젝트</h4>
      <table class="table ongoing">

        <thead class="table-light">
          <tr>
            <th scope="col" width="7%">번호</th>
            <th scope="col" width="43%">프로젝트명</th>
            <th scope="col" width="20%" class="text-center">달성률</th>
            <th scope="col" class="text-end">남은기간</th>
            <th scope="col" class="text-center">모집금액</th>
            <th scope="col" class="text-center">취소</th>


          </tr>
        </thead>
        <tbody>
          <tr class="data">
            <th scope="row" class="projNo"></th>
            <td><a class="projTitle" href="">취미로의 첫 여행:투톤 젤캔들만들기...</a></td>
            <td>
              <div class="progress">
                <div class="progress-bar bg-warning" role="progressbar" style="width: 0%;" aria-valuenow="25"
                  aria-valuemin="0" aria-valuemax="100"></div>
                진행예정
              </div>
            </td>
            <td class="text-end restDay">14일</td>
            <td class="text-end totalFm">680,000원</td>
            <td class="text-center"><button type="button" class="btn btn-outline-danger btn-sm cancle">취소</button>
            </td>
          </tr>
          <!--
          <th scope="row">0001</th>
          <td><a href="">취미로의 첫 여행:투톤 젤캔들만들기...</a></td>
          <td>
            <div class="progress">
              <div class="progress-bar bg-warning" role="progressbar" style="width: 0%;" aria-valuenow="25"
                aria-valuemin="0" aria-valuemax="100"></div>
              진행예정
            </div>
          </td>
          <td class="text-end">14일</td>
          <td class="text-end">680,000원</td>
          <td class="text-center"><button type="button" class="btn btn-outline-danger btn-sm">취소</button>
          </td>
        </tr>


          <tr>
            <th scope="row">0001</th>
            <td><a href="">취미로의 첫 여행:투톤 젤캔들만들기...</a></td>
            <td>
              <div class="progress">
                <div class="progress-bar bg-warning" role="progressbar" style="width: 25%;" aria-valuenow="25"
                  aria-valuemin="0" aria-valuemax="100">25%</div>
              </div>
            </td>
            <td class="text-end">14일</td>
            <td class="text-end">680,000원</td>
            <td class="text-center"><button type="button" class="btn btn-outline-danger btn-sm">취소</button>
            </td>
          </tr>

          <tr>
            <th scope="row">0001</th>

            <td>취미로의 첫 여행:투톤 젤캔들만들기...</td>
            <td>
              <div class="progress">
                <div class="progress-bar bg-primary" role="progressbar" style="width: 50%;" aria-valuenow="50"
                  aria-valuemin="0" aria-valuemax="100">50%</div>
              </div>



            </td>
            <td class="text-end">14일</td>
            <td class="text-end">680,000원</td>

            <td class="text-center"><button type="button" class="btn btn-outline-danger btn-sm">취소</button></td>
          </tr>

          <tr>
            <th scope="row">0001</th>

            <td>취미로의 첫 여행:투톤 젤캔들만들기...</td>

            <td>

              <div class="progress">
                <div class="progress-bar bg-info" role="progressbar" style="width: 75%;" aria-valuenow="75"
                  aria-valuemin="0" aria-valuemax="100">75%</div>
              </div>


            </td>
            <td class="text-end">14일</td>
            <td class="text-end">680,000원</td>

            <td class="text-center"><button type="button" class="btn btn-outline-danger btn-sm">취소</button>
            </td>
          </tr>

          <tr>
            <th scope="row">0001</th>

            <td>취미로의 첫 여행:투톤 젤캔들만들기...</td>
            <td>
              <div class="progress">
                <div class="progress-bar bg-success" role="progressbar" style="width: 100%;" aria-valuenow="100"
                  aria-valuemin="0" aria-valuemax="100">100%</div>
              </div>
            </td>
            <td class="text-end">14일</td>
            <td class="text-end">4,680,000원</td>
            <td>
            </td>
          </tr>


          <tr>
            <th scope="row">0001</th>

            <td>취미로의 첫 여행:투톤 젤캔들만들기...</td>
            <td>
              <div class=" progress">
                <div class="progress-bar bg-secondary" role="progressbar" style="width: 100%;" aria-valuenow="100"
                  aria-valuemin="0" aria-valuemax="100">제한수량도달</div>
              </div>


            </td>
            <td class="text-end">14일</td>
            <td class="text-end">680,000원</td>


            <td>
            </td>
          </tr>


-->
        </tbody>
      </table>
      <br>


      <h4>전체 프로젝트</h4>

      <table class="table allProj">

        <thead class="table-light">
          <tr>
            <th scope="col" width="7%">번호</th>
            <th scope="col" width="43%">프로젝트명</th>
            <th scope="col" width="8%">목표도달</th>
            <th scope="col" class="text-center">기간</th>
            <th scope="col" class="text-center">모집금액</th>
            <th scope="col" class="text-center">참여자</th>


          </tr>
        </thead>
        <tbody>

          <tr class="data">
            <th scope="row projNo">0001</th>
            <td><a class="projTitle" href="">취미로의 첫 여행:투톤 젤캔들만들기...</a></td>
            <td class="text-center">
              <div class="state bg-secondary text-white">예정</div>
            </td>
            <td class="text-center term">2021/08/18 ~ 2021/09/18</td>
            <td class="text-end totalFm">0원</td>
            <td class="text-center joiner"><button type="button"
                class="btn btn-outline-success btn-sm joiner">보기</button></td>

          </tr>
          <!--
          <tr>
            <th scope="row">0001</th>

            <td>취미로의 첫 여행:투톤 젤캔들만들기...</td>
            <td class="text-center">
              <div class="state bg-info text-white">진행</div>
            </td>
            <td class="text-center">2021/08/18 ~ 2021/09/18</td>
            <td class="text-end">680,000원</td>
            <td></td>

          </tr>

          <tr>
            <th scope="row">0002</th>

            <td>취미로의 첫 여행:투톤 젤캔들만들기...</td>
            <td class="text-center">
              <div class="state bg-warning text-dark">실패</div>
            </td>
            <td class="text-center">2021/08/18 ~ 2021/09/18</td>
            <td class="text-end">4,680,000원</td>
            <td></td>

          </tr>

          <tr>
            <th scope="row">0003</th>

            <td>취미로의 첫 여행:투톤 젤캔들만들기...</td>
            <td class="text-center">
              <div class="state bg-danger text-white">취소</div>
            </td>
            <td class="text-center">2021/08/18 ~ 2021/09/18</td>
            <td class="text-end">680,000원</td>

            <td></td>

          </tr>

          <tr>
            <th scope="row">0004</th>

            <td>취미로의 첫 여행:투톤 젤캔들만들기...</td>
            <td class="text-center">
              <div class="state bg-success text-white">성공</div>
            </td>
            <td class="text-center">2021/08/18 ~ 2021/09/18</td>
            <td class="text-end">680,000원</td>

            <td class="text-center"><button type="button" class="btn btn-outline-success btn-sm">보기</button></td>

          </tr>

          <tr>
            <th scope="row">0005</th>

            <td>취미로의 첫 여행:투톤 젤캔들만들기...</td>
            <td class="text-center">
              <div class="state bg-success text-white">성공</div>
            </td>
            <td class="text-center">2021/08/18 ~ 2021/09/18</td>
            <td class="text-end">680,000원</td>

            <td class="text-center"><button type="button" class="btn btn-outline-success btn-sm">보기</button></td>

          </tr>
-->
        </tbody>
      </table>

      <div class="pagination_container">
        <ul class="pagination">
          <li class="page-item disabled">
            <a class="page-link" href="#" tabindex="-1" aria-disabled="true">&laquo;</a>
          </li>
          <li class="page-item"><a class="page-link" href="#">1</a></li>
          <li class="page-item active" aria-current="page">
            <a class="page-link" href="#">2</a>
          </li>
          <li class="page-item"><a class="page-link" href="#">3</a></li>
          <li class="page-item">
            <a class="page-link" href="#">&raquo;</a>
          </li>
        </ul>
      </div>
    </div>

  </section>
  <footer class="main_footer">

    <div class="footer_second_warp">
      <div class="footer_info_warp">
        <div class="info_first_warp">
          <span class="info_item1">회사명</span>
          <span class="info_item2">크크펀딩</span>
          <span class="info_item1">주소</span>
          <span class="info_item2">경기도 성남시 분당구 성남대로 34 6층(구미동 하나프라자빌딩)</span>
          <span class="info_item1">대표</span>
          <span class="info_item2">오문정</span>
          <span class="info_item1">사업자등록번호</span>
          <span class="info_item2">105-87-52823</span>
        </div>
        <div class="info_second_warp">
          <span class="info_item1">통신판매업 신고번호</span>
          <span class="info_item2">2019-3010165-30-2-02129</span>
          <span class="info_item1">대표번호</span>
          <span class="info_item2">031-606-9319</span>
        </div>
        <div class="info_last_warp">
          <span class="last_warp_item">© 2021 KKPD Inc.</span>
        </div>
      </div>
      <div class="footer_info_icon">
        <i class="fab fa-java fa-lg"></i>
        <i class="fab fa-js fa-lg"></i>
        <i class="fab fa-html5 fa-lg"></i>
        <i class="fab fa-css3 fa-lg"></i>
        <i class="fas fa-user-md fa-lg"></i>
        <i class="fas fa-head-side-mask fa-lg"></i>
      </div>
    </div>
    <div class="footer_last_info">
      <div class="footer_last_info_div">
        <span class="last_info_item">
          크크펀딩은 플랫폼 제공자로서 프로젝트의 당사자가 아니며, 직접적인 통신판매를 진행하지 않습니다. 프로젝트의 완수 및 선물제공의 책임은 해당 프로젝트의 창작자에게 있으며, 프로젝트와 관련하여 후원자와
          발생하는 법적 분쟁에 대한 책임은 해당 창작자가 부담합니다.
        </span>
      </div>
    </div>
  </footer>

</body>

</html>